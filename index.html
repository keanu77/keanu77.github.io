<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>健康計算機 - Health Calculator</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>健康計算機 Health Calculator</h1>
            <p>專業的身體健康指標計算工具</p>
            <div class="creator-info">
                <p>製作者：<span class="creator-name">運動醫學 吳易澄醫師</span></p>
                <p class="usage-counter">使用次數：<span id="counter-display">0</span> 次</p>
            </div>
        </header>

        <nav class="calculator-tabs">
            <button class="tab-btn active" data-tab="body-composition">身體組成與熱量計算</button>
            <button class="tab-btn" data-tab="questionnaire">健康問卷</button>
        </nav>

        <!-- Body Composition & Calorie Calculator -->
        <div class="calculator-section active" id="body-composition">
            <h2>身體組成與熱量計算</h2>
            
            <div class="composition-tabs">
                <button class="composition-tab-btn active" data-composition="bmi">BMI 身體質量指數</button>
                <button class="composition-tab-btn" data-composition="bmr">BMR 基礎代謝率</button>
                <button class="composition-tab-btn" data-composition="tdee">TDEE 總消耗</button>
                <button class="composition-tab-btn" data-composition="bodyfat">體脂肪率</button>
                <button class="composition-tab-btn" data-composition="ffmi">FFMI 指數</button>
            </div>

            <!-- BMI Calculator Form -->
            <div class="composition-form active" id="bmi-form">
                <h3>BMI - 身體質量指數計算</h3>
                <div class="input-group">
                    <label for="height-bmi">身高 (cm)</label>
                    <input type="number" id="height-bmi" placeholder="例如：170">
                </div>
                <div class="input-group">
                    <label for="weight-bmi">體重 (kg)</label>
                    <input type="number" id="weight-bmi" placeholder="例如：65">
                </div>
                <div class="input-group">
                    <label for="standard">標準選擇</label>
                    <select id="standard">
                        <option value="who">WHO 國際標準</option>
                        <option value="asian">台灣標準</option>
                    </select>
                </div>
                <button onclick="calculateBMI()">計算 BMI</button>
                <div class="result" id="bmi-result"></div>
                <div class="explanation" id="bmi-explanation">
                    <h4>BMI 身體質量指數詳細說明</h4>
                    <p><strong>計算公式：</strong>體重(kg) ÷ 身高²(m²)</p>
                    <p><strong>用途：</strong>BMI 是世界衛生組織推薦的評估成人體重狀況的標準指標，用來判斷是否有體重過輕、正常、過重或肥胖的風險。</p>
                    <p><strong>標準差異：</strong></p>
                    <ul>
                        <li><strong>WHO 國際標準：</strong>體重過輕 <18.5，正常範圍 18.5-24.9，過重 25-29.9，肥胖 ≥30</li>
                        <li><strong>台灣標準：</strong>依據國民健康署建議，健康體重範圍為 18.5-23.9，體重過重 24-26.9，肥胖 ≥27</li>
                    </ul>
                    <p><strong>限制性：</strong>BMI 無法區分肌肉和脂肪重量，肌肉發達的運動員可能會被誤判為過重。建議搭配體脂肪率等其他指標綜合評估。</p>
                    <p><strong>健康風險：</strong>BMI 過高與糖尿病、心血管疾病、高血壓等慢性病風險增加相關。</p>
                </div>
            </div>

            <!-- BMR Calculator Form -->
            <div class="composition-form" id="bmr-form">
                <h3>BMR - 基礎代謝率計算</h3>
                <div class="input-group">
                    <label>性別</label>
                    <div class="radio-group">
                        <input type="radio" id="male-bmr" name="gender-bmr" value="male" checked>
                        <label for="male-bmr">男性</label>
                        <input type="radio" id="female-bmr" name="gender-bmr" value="female">
                        <label for="female-bmr">女性</label>
                    </div>
                </div>
                <div class="input-group">
                    <label for="age-bmr">年齡</label>
                    <input type="number" id="age-bmr" placeholder="例如：25">
                </div>
                <div class="input-group">
                    <label for="height-bmr">身高 (cm)</label>
                    <input type="number" id="height-bmr" placeholder="例如：170">
                </div>
                <div class="input-group">
                    <label for="weight-bmr">體重 (kg)</label>
                    <input type="number" id="weight-bmr" placeholder="例如：65">
                </div>
                <div class="input-group">
                    <label for="formula">計算公式</label>
                    <select id="formula">
                        <option value="mifflin">Mifflin-St Jeor 公式</option>
                        <option value="harris">Harris-Benedict 公式</option>
                    </select>
                </div>
                <button onclick="calculateBMR()">計算 BMR</button>
                <div class="result" id="bmr-result"></div>
                <div class="explanation" id="bmr-explanation">
                    <h4>BMR 基礎代謝率詳細說明</h4>
                    <p><strong>定義：</strong>基礎代謝率是指身體在完全休息，不進行任何活動狀態下維持基本生理功能所需要的能量。</p>
                    <p><strong>Mifflin-St Jeor 公式：</strong>目前最被廣泛採用且準確性較高的公式</p>
                    <ul>
                        <li>男性：BMR = 10 × 體重(kg) + 6.25 × 身高(cm) - 5 × 年齡 + 5</li>
                        <li>女性：BMR = 10 × 體重(kg) + 6.25 × 身高(cm) - 5 × 年齡 - 161</li>
                    </ul>
                    <p><strong>Harris-Benedict 公式：</strong>傳統經典公式</p>
                    <ul>
                        <li>男性：BMR = 88.362 + (13.397 × 體重) + (4.799 × 身高) - (5.677 × 年齡)</li>
                        <li>女性：BMR = 447.593 + (9.247 × 體重) + (3.098 × 身高) - (4.330 × 年齡)</li>
                    </ul>
                </div>
            </div>

            <!-- TDEE Calculator Form -->
            <div class="composition-form" id="tdee-form">
                <h3>TDEE - 每日總消耗熱量計算</h3>
                <div class="input-group">
                    <label>性別</label>
                    <div class="radio-group">
                        <input type="radio" id="male-tdee" name="gender-tdee" value="male" checked>
                        <label for="male-tdee">男性</label>
                        <input type="radio" id="female-tdee" name="gender-tdee" value="female">
                        <label for="female-tdee">女性</label>
                    </div>
                </div>
                <div class="input-group">
                    <label for="age-tdee">年齡</label>
                    <input type="number" id="age-tdee" placeholder="例如：25">
                </div>
                <div class="input-group">
                    <label for="height-tdee">身高 (cm)</label>
                    <input type="number" id="height-tdee" placeholder="例如：170">
                </div>
                <div class="input-group">
                    <label for="weight-tdee">體重 (kg)</label>
                    <input type="number" id="weight-tdee" placeholder="例如：65">
                </div>
                <div class="input-group">
                    <label for="activity">活動強度</label>
                    <select id="activity">
                        <option value="1.2">久坐（幾乎沒有運動）</option>
                        <option value="1.375">輕度活動（每週1-3次輕度運動）</option>
                        <option value="1.55">中度活動（每週3-5次中度運動）</option>
                        <option value="1.725">高強度活動（每週6-7次運動）</option>
                        <option value="1.9">極高強度（體力勞動或每日2次運動）</option>
                    </select>
                </div>
                <button onclick="calculateTDEE()">計算 TDEE</button>
                <div class="result" id="tdee-result"></div>
                <div class="explanation" id="tdee-explanation">
                    <h4>TDEE 每日總消耗熱量詳細說明</h4>
                    <p><strong>定義：</strong>TDEE 是指一個人在一天內所有活動的總熱量消耗，包括基礎代謝率、活動消耗和食物熱效應。</p>
                    <p><strong>計算方式：</strong>TDEE = BMR × 活動係數</p>
                    <p><strong>活動係數說明：</strong></p>
                    <ul>
                        <li><strong>1.2：</strong>久坐生活方式，幾乎沒有運動</li>
                        <li><strong>1.375：</strong>輕度活動，每週1-3次輕度運動</li>
                        <li><strong>1.55：</strong>中度活動，每週3-5次中度運動</li>
                        <li><strong>1.725：</strong>高強度活動，每週6-7次運動</li>
                        <li><strong>1.9：</strong>極高強度，體力勞動或每日2次運動</li>
                    </ul>
                </div>
            </div>

            <!-- Body Fat Calculator Form -->
            <div class="composition-form" id="bodyfat-form">
                <h3>體脂肪率計算</h3>
                <div class="input-group">
                    <label for="method">計算方法</label>
                    <select id="method" onchange="toggleBodyFatInputs()">
                        <option value="us-navy">美國海軍公式</option>
                        <option value="ymca">YMCA 公式</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>性別</label>
                    <div class="radio-group">
                        <input type="radio" id="male-bf" name="gender-bf" value="male" checked onchange="toggleBodyFatInputs()">
                        <label for="male-bf">男性</label>
                        <input type="radio" id="female-bf" name="gender-bf" value="female" onchange="toggleBodyFatInputs()">
                        <label for="female-bf">女性</label>
                    </div>
                </div>
                <div class="input-group">
                    <label for="height-bf">身高 (cm)</label>
                    <input type="number" id="height-bf" placeholder="例如：170">
                </div>
                <div class="input-group" id="neck-group">
                    <label for="neck">頸圍 (cm)</label>
                    <input type="number" id="neck" placeholder="例如：36">
                </div>
                <div class="input-group">
                    <label for="waist">腰圍 (cm)</label>
                    <input type="number" id="waist" placeholder="例如：80">
                </div>
                <div class="input-group" id="hip-group">
                    <label for="hip">臀圍 (cm)</label>
                    <input type="number" id="hip" placeholder="例如：95">
                </div>
                <div class="input-group" id="weight-group-ymca" style="display: none;">
                    <label for="weight-bf">體重 (kg)</label>
                    <input type="number" id="weight-bf" placeholder="例如：65">
                </div>
                <button onclick="calculateBodyFat()">計算體脂肪率</button>
                <div class="result" id="bodyfat-result"></div>
                <div class="explanation" id="bodyfat-explanation">
                    <h4>體脂肪率詳細說明</h4>
                    <p><strong>定義：</strong>體脂肪率是指身體脂肪重量佔總體重的百分比，是評估身體組成的重要指標。</p>
                    <p><strong>美國海軍公式：</strong>使用身高、頸圍、腰圍（女性加臀圍）進行計算</p>
                    <p><strong>YMCA 公式：</strong>使用腰圍與體重的比例進行估算</p>
                    <p><strong>健康範圍：</strong></p>
                    <ul>
                        <li><strong>男性：</strong>運動員6-13%，健身14-17%，一般18-25%，過高≥26%</li>
                        <li><strong>女性：</strong>運動員16-20%，健身21-24%，一般25-31%，過高≥32%</li>
                    </ul>
                </div>
            </div>

            <!-- FFMI Calculator Form -->
            <div class="composition-form" id="ffmi-form">
                <h3>FFMI - 去脂體重指數計算</h3>
                <div class="input-group">
                    <label for="height-ffmi">身高 (cm)</label>
                    <input type="number" id="height-ffmi" placeholder="例如：170">
                </div>
                <div class="input-group">
                    <label for="weight-ffmi">體重 (kg)</label>
                    <input type="number" id="weight-ffmi" placeholder="例如：70">
                </div>
                <div class="input-group">
                    <label for="bodyfat-ffmi">體脂肪率 (%)</label>
                    <input type="number" id="bodyfat-ffmi" placeholder="例如：15" step="0.1">
                </div>
                <button onclick="calculateFFMI()">計算 FFMI</button>
                <div class="result" id="ffmi-result"></div>
                <div class="explanation" id="ffmi-explanation">
                    <h4>FFMI 去脂體重指數詳細說明</h4>
                    <p><strong>定義：</strong>FFMI (Fat-Free Mass Index) 是去脂體重指數，用來評估相對於身高的肌肉量。</p>
                    <p><strong>計算公式：</strong></p>
                    <ul>
                        <li>去脂體重 = 體重 × (1 - 體脂肪率/100)</li>
                        <li>FFMI = 去脂體重(kg) ÷ 身高²(m²)</li>
                        <li>標準化FFMI = FFMI + 6.1 × (1.8 - 身高(m))</li>
                    </ul>
                    <p><strong>評估標準：</strong></p>
                    <ul>
                        <li><strong>16以下：</strong>肌肉量不足</li>
                        <li><strong>16-18：</strong>一般水準</li>
                        <li><strong>18-20：</strong>良好水準</li>
                        <li><strong>20-22：</strong>優秀水準</li>
                        <li><strong>22-25：</strong>精英水準</li>
                        <li><strong>25以上：</strong>可能超出自然訓練上限</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Questionnaire Section -->
        <div class="calculator-section" id="questionnaire">
            <h2>健康評估問卷</h2>
            
            <div class="questionnaire-tabs">
                <button class="questionnaire-tab-btn active" data-questionnaire="sppb">SPPB 身體功能評估</button>
                <button class="questionnaire-tab-btn" data-questionnaire="parq">PAR-Q+ 運動準備問卷</button>
                <button class="questionnaire-tab-btn" data-questionnaire="sarcf">SARC-F 肌少症篩檢</button>
            </div>

            <!-- SPPB Questionnaire -->
            <div class="questionnaire-form active" id="sppb-form">
                <h3>SPPB - 簡易身體功能測試</h3>
                <p class="questionnaire-desc">Short Physical Performance Battery (SPPB) 是評估下肢功能、平衡能力和步行能力的標準化測試。</p>
                
                <div class="sppb-section">
                    <h4>平衡測試</h4>
                    <p>請嘗試以下三種站立姿勢，每種維持10秒鐘：</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="balance" value="0">無法完成併腳站立10秒</label>
                        <label><input type="radio" name="balance" value="1">可完成併腳站立，但無法完成半前腳步姿勢10秒</label>
                        <label><input type="radio" name="balance" value="2">可完成半前腳步姿勢，但無法完成全前腳步姿勢10秒</label>
                        <label><input type="radio" name="balance" value="3">可完成全前腳步姿勢10秒</label>
                        <label><input type="radio" name="balance" value="4">可完成全前腳步姿勢超過10秒</label>
                    </div>
                </div>

                <div class="sppb-section">
                    <h4>步行速度測試</h4>
                    <p>正常步行4公尺所需時間：</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="walktime" value="0">無法完成或需要超過8.7秒</label>
                        <label><input type="radio" name="walktime" value="1">6.21-8.7秒</label>
                        <label><input type="radio" name="walktime" value="2">4.82-6.2秒</label>
                        <label><input type="radio" name="walktime" value="3">3.62-4.81秒</label>
                        <label><input type="radio" name="walktime" value="4">少於3.62秒</label>
                    </div>
                </div>

                <div class="sppb-section">
                    <h4>椅子起立測試</h4>
                    <p>雙手抱胸，從椅子上起立5次所需時間：</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="chairstand" value="0">無法完成或需要60秒以上</label>
                        <label><input type="radio" name="chairstand" value="1">16.7-60秒</label>
                        <label><input type="radio" name="chairstand" value="2">13.7-16.69秒</label>
                        <label><input type="radio" name="chairstand" value="3">11.2-13.69秒</label>
                        <label><input type="radio" name="chairstand" value="4">少於11.2秒</label>
                    </div>
                </div>

                <button onclick="calculateSPPB()">計算 SPPB 分數</button>
                <div class="result" id="sppb-result"></div>

                <div class="info-section">
                    <h4>SPPB 簡易身體功能測試說明</h4>
                    <p><strong>用途：</strong>評估老年人下肢功能和跌倒風險，預測未來功能衰退和住院風險。</p>
                    <p><strong>評分：</strong>總分0-12分，分數越高表示身體功能越好。</p>
                    <ul>
                        <li><strong>0-3分：</strong>嚴重功能限制，高跌倒風險</li>
                        <li><strong>4-6分：</strong>中度功能限制，需要介入</li>
                        <li><strong>7-9分：</strong>輕度功能限制，持續運動</li>
                        <li><strong>10-12分：</strong>功能良好，維持現況</li>
                    </ul>
                    
                    <h4>PAR-Q+ (運動準備問卷)</h4>
                    <p><strong>用途：</strong>篩選運動前的健康風險，確保安全參與體育活動。</p>
                    <p><strong>評估：</strong>如有任何「是」的答案，建議諮詢醫療專業人員後再開始運動計畫。</p>
                </div>
            </div>

            <!-- PAR-Q Questionnaire -->
            <div class="questionnaire-form" id="parq-form">
                <h3>PAR-Q+ - 運動準備問卷</h3>
                <p class="questionnaire-desc">Physical Activity Readiness Questionnaire (PAR-Q+) 用於評估參與體育活動前的健康狀況和潛在風險。</p>
                
                <div class="parq-section">
                    <h4>一般健康問題</h4>
                    <div class="question-group">
                        <p>1. 醫生是否曾告訴過您有心臟病，且只能在醫療監督下運動？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q1" value="yes">是</label>
                            <label><input type="radio" name="q1" value="no">否</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <p>2. 您是否在運動時感到胸痛？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q2" value="yes">是</label>
                            <label><input type="radio" name="q2" value="no">否</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <p>3. 在過去一個月內，您是否曾在非運動狀態下感到胸痛？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q3" value="yes">是</label>
                            <label><input type="radio" name="q3" value="no">否</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <p>4. 您是否會因為頭暈而失去平衡，或曾經失去意識？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q4" value="yes">是</label>
                            <label><input type="radio" name="q4" value="no">否</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <p>5. 您是否有骨關節問題，可能因運動而惡化？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q5" value="yes">是</label>
                            <label><input type="radio" name="q5" value="no">否</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <p>6. 您目前是否正在服用血壓或心臟疾病的處方藥物？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q6" value="yes">是</label>
                            <label><input type="radio" name="q6" value="no">否</label>
                        </div>
                    </div>

                    <div class="question-group">
                        <p>7. 您是否知道任何其他不應該參與運動的理由？</p>
                        <div class="radio-group">
                            <label><input type="radio" name="q7" value="yes">是</label>
                            <label><input type="radio" name="q7" value="no">否</label>
                        </div>
                    </div>
                </div>

                <button onclick="calculatePARQ()">評估 PAR-Q+ 結果</button>
                <div class="result" id="parq-result"></div>

                <div class="info-section">
                    <h4>PAR-Q+ 運動準備問卷說明</h4>
                    <p><strong>用途：</strong>識別在開始運動計畫前可能需要醫療諮詢的個人。</p>
                    <p><strong>評估標準：</strong></p>
                    <ul>
                        <li><strong>全部回答「否」：</strong>您可以安全地開始運動計畫</li>
                        <li><strong>任何回答「是」：</strong>建議先諮詢醫療專業人員</li>
                    </ul>
                </div>
            </div>

            <!-- SARC-F Questionnaire -->
            <div class="questionnaire-form" id="sarcf-form">
                <h3>SARC-F - 肌少症功能篩檢問卷</h3>
                <p class="questionnaire-desc">SARC-F (Sarcopenia Functional Questionnaire) 是一種簡便且有效的肌少症篩檢工具，透過評估日常生活功能來識別肌少症風險。</p>
                
                <div class="question-group">
                    <p><strong>1. 握力 (Strength)：</strong>您在搬運或提起 4.5 公斤 (約10磅) 的物品時有多困難？</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="sarcf-q1" value="0">沒有困難</label>
                        <label><input type="radio" name="sarcf-q1" value="1">有點困難</label>
                        <label><input type="radio" name="sarcf-q1" value="2">非常困難或無法做到</label>
                    </div>
                </div>

                <div class="question-group">
                    <p><strong>2. 輔助行走 (Assistance walking)：</strong>您在房間內行走時有多困難？</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="sarcf-q2" value="0">沒有困難</label>
                        <label><input type="radio" name="sarcf-q2" value="1">有點困難</label>
                        <label><input type="radio" name="sarcf-q2" value="2">非常困難、需要輔具，或無法做到</label>
                    </div>
                </div>

                <div class="question-group">
                    <p><strong>3. 起身 (Rise from a chair)：</strong>您從椅子或床上起身時有多困難？</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="sarcf-q3" value="0">沒有困難</label>
                        <label><input type="radio" name="sarcf-q3" value="1">有點困難</label>
                        <label><input type="radio" name="sarcf-q3" value="2">非常困難、需要協助，或無法做到</label>
                    </div>
                </div>

                <div class="question-group">
                    <p><strong>4. 爬樓梯 (Climb stairs)：</strong>您爬 10 個階梯時有多困難？</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="sarcf-q4" value="0">沒有困難</label>
                        <label><input type="radio" name="sarcf-q4" value="1">有點困難</label>
                        <label><input type="radio" name="sarcf-q4" value="2">非常困難或無法做到</label>
                    </div>
                </div>

                <div class="question-group">
                    <p><strong>5. 跌倒 (Falls)：</strong>過去一年內您跌倒了幾次？</p>
                    <div class="radio-group-vertical">
                        <label><input type="radio" name="sarcf-q5" value="0">沒有跌倒</label>
                        <label><input type="radio" name="sarcf-q5" value="1">1-3 次</label>
                        <label><input type="radio" name="sarcf-q5" value="2">4 次或以上</label>
                    </div>
                </div>

                <button onclick="calculateSARCF()">計算 SARC-F 分數</button>
                <div class="result" id="sarcf-result"></div>

                <div class="info-section">
                    <h4>SARC-F (肌少症功能篩檢問卷)</h4>
                    <p><strong>用途：</strong>快速篩檢肌少症風險，評估肌肉功能和日常生活活動能力。</p>
                    <p><strong>評分：</strong>總分 0-10 分，分數≥4分表示肌少症篩檢陽性，建議進一步醫學檢查。</p>
                    <p><strong>評估項目：</strong>握力、步行能力、起身能力、爬樓梯能力和跌倒歷史。</p>
                </div>
            </div>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h3>結果匯出</h3>
            <button onclick="exportToImage()" class="export-btn">匯出為圖片</button>
        </div>

        <footer>
            <p>※ 本計算機僅供參考，具體健康狀況請諮詢專業醫療人員</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>